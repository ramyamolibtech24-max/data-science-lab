import pandas as pd
import numpy as np
from sklearn.preprocessing import StandardScaler, MinMaxScaler


df = pd.read_csv(r"C:\Users\Ramya Oli\Downloads\Automobile.csv")

print("Before preprocessing:")
print(df.info())


if "horsepower" in df.columns:
    df.drop(columns=["horsepower"], inplace=True)


for col in df.select_dtypes(include=[np.number]).columns:
    df[col].fillna(df[col].median(), inplace=True)

print("\nAfter handling missing values:")
print(df.info())

num_cols = df.select_dtypes(include=[np.number]).columns  # numeric columns


std_scaler = StandardScaler()
df_std = df.copy()
df_std[num_cols] = std_scaler.fit_transform(df_std[num_cols])

df_std.to_csv(r"C:\Users\Ramya Oli\Downloads\Automobile_standardized.csv", index=False)
print(" File saved: Automobile_standardized.csv")


mm_scaler = MinMaxScaler()
df_mm = df.copy()
df_mm[num_cols] = mm_scaler.fit_transform(df_mm[num_cols])


df_mm.to_csv(r"C:\Users\Ramya Oli\Downloads\Automobile_minmax.csv", index=False)
print(" File saved: Automobile_minmax.csv")
